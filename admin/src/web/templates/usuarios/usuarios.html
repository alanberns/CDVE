{% extends "layout.html" %}
{% block title %}Usuarios{% endblock %}
{% block head %}
  {{ super() }}
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
    <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
      <path
        d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"
      />
    </symbol>
  </svg>
{% endblock %}
{% block content %}
<div class="d-flex flex-column align-items-center">
  <h1 class="mx-5"> Usuarios </h1>

  <a href="{{url_for('usuarios.add_usuario_view')}}"> <button>Añadir nuevo usuario</button></a>

  <section><h6>Buscar por:</h6>
    <form  class="row g-3 mx-5" action="{{ url_for('usuarios.busqueda_filtrada') }}" method="get">
        <label for="email" class="form-label">Email:</label>
        <input type="email" name="email" id="email" >

        <label for="estado" class="form-label">Estado de usuario:</label>
        <select name="estado" id="estado">
          <option >todos</option>
          <option >inactivo</option>
          <option >activo</option>
        </select>
        <button>Buscar</button>
    </form>
  </section>

  <table class="table table-striped">
    <thead>
      <tr class="table-dark">
        <th>#</th>
        <th>Username</th>
        <th>Email</th>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>Activo</th>
        <th>Cambiar estado</th>
        <th>Ver detalle</th>
      </tr>
    </thead>
    <tbody>
      {% for usuario in usuarios_pag.items %}
      <tr>
        <th>{{ usuario.id }}</th>
        <th>{{ usuario.username }}</th>
        <th>{{ usuario.email }}</th>
        <th>{{ usuario.first_name }}</th>
        <th>{{ usuario.last_name }}</th>
        {% if usuario.activo %}
        <th>Si</th>
        <th><a href="{{url_for('usuarios.modify_activo', id=usuario.id)}}"><button>Dar de baja</button></a></th>
        {% endif %}
        {% if not usuario.activo %}
        <th>No</th>
        <th><a href="{{url_for('usuarios.modify_activo', id=usuario.id)}}"><button>Dar de alta</button></a></th>
        {% endif %}
        <th><a href="{{ url_for('usuarios.view_usuario', id=usuario.id)}}"><button>Ver detalle</button></a></th>
      </tr>
      {% else %}
      <th>No hay resultados</th>
      {% endfor %}
    </tbody>
  </table>
  <div class=pagination>
    {%- for page in usuarios_pag.iter_pages() %}
        {% if page %}
            {% if page != usuarios_pag.page %}
                <a href="{{ url_for('usuarios.usuario_index', page=page ) }}"><button>{{ page }}</button></a>
            {% else %}
                <strong>{{ page }}</strong>
            {% endif %}
        {% else %}
            <span class=ellipsis>…</span>
        {% endif %}
    {%- endfor %}
  </div>
</div>
{% endblock %}