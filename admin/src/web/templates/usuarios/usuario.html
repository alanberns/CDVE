{% extends "layout.html" %}
{% block title %}Usuario{% endblock %}
{% block head %}
  {{ super() }}
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
      <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
    </symbol>
  </svg>
{% endblock %}
{% block content %}
<div class="d-flex flex-column align-items-center">
  <h1 class="mx-5"> Usuario </h1>

    <form class="row g-3 mx-5" action=" {{ url_for('usuarios.update_usuario', id=usuario.id)}}" method="post" onsubmit="return confirm('¿Estas seguro que deseas editar el usuario?');">
      {{ form.csrf_token }} 
      <div class="form-floating mb-3">
        <input type="text" name="id" id="floatingInput" value="{{ usuario.id }}" class="form-control" readonly>
        <label for="floatingInput">ID</label>
      </div>
      {% if usuario.activo %}
      <div class="form-floating mb-3">
        <input type="text" name="" id="floatingInput" value="Si" class="form-control" readonly>
        <label for="floatingInput">Activo</label>
      </div>
      {% endif %}
      {% if not usuario.activo %}
      <div class="form-floating mb-3">
        <input type="text" name="" id="floatingInput" value="No" class="form-control" readonly>
        <label for="floatingInput">Activo</label>
      </div>
      {% endif %}
      <div class="form-floating mb-3">
        <input type="text" name="" id="floatingInput" value="{{ usuario.created_at }}" class="form-control" readonly>
        <label for="floatingInput">Fecha de alta</label>
      </div>
      <div class="form-floating mb-3">
        <input type="text" name="" id="floatingInput" value="{{usuario.updated_at}}" class="form-control" readonly>
        <label for="floatingInput">Última modificación</label>
      </div>
  
      <div class="form-floating mb-3">
        {{form.email(class="form-control")}}
        <label for="email">{{form.email.label}}</label>
      </div>
      <div class="form-floating mb-3">
        {{form.username(class="form-control")}}
        <label for="username">{{form.username.label}}</label>
      </div>
      <div class="form-floating mb-3">
        {{form.first_name(class="form-control")}}
        <label for="first_name">{{form.first_name.label}}</label>
      </div>
      <div class="form-floating mb-3">
        {{form.last_name(class="form-control")}}
        <label for="last_name">{{form.last_name.label}}</label>
      </div>
      {{form.modificar(class="btn btn-primary")}}
    </form>

    <h6>Roles</h6>
    <table class="table table-striped">
      <thead>
        <tr class="table-dark">
          <th>Nombre del rol</th>
          <th>Acción</th>
        </tr>
      </thead>
      <tbody>
        {% for rol in roles %}
        <tr>
          {% if rol in usuario.roles %}
            <th>{{rol.nombre}}</th>
            <th><a href="{{ url_for('usuarios.quitar_rol', rol_id=rol.id, usuario_id=usuario.id)}}" method="get">
              <button>Quitar rol</button></a>
            </th>
          {% else %}
            <th>{{rol.nombre}}</th>
            <th><a href="{{url_for('usuarios.asignar_rol', rol_id=rol.id, usuario_id=usuario.id)}}" method="get">
            <button>Asignar rol</button></a>
            </th>
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <a href="{{url_for('home')}}"><button>Volver al inicio</button> </a>
    <a href="{{url_for('usuarios.usuario_index')}}"><button>Menú  usuarios</button></a>
  
</div>
{% endblock %}